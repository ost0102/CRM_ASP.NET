#EvbMgmtHistory@Search
--EvbMgmtHistory@SearchSELECT M.USER_AUTH_ID     , M.BUSN_NM     , M.BUSN_NO  FROM EVB_MEMB_SET M  WHERE 1=1  [SEARCH_KEY]    AND ( 1=2        OR M.BUSN_NO LIKE REPLACE('%@SEARCH_KEY%', '-','')        OR M.BUSN_NM LIKE '%@SEARCH_KEY%'        OR M.USER_AUTH_ID LIKE '@SEARCH_KEY%'         )  [/SEARCH_KEY]  ORDER BY M.BUSN_NM
#EvbMgmtHistory@SearchDetail
--EvbMgmtHistory@SearchDetailSELECT *FROM (SELECT 'N' As CHK	 , 'TAX' AS DOC_DIV     , (CASE WHEN A.ETAXBIL_CL_CD = '01' THEN '세금계산서'               WHEN A.ETAXBIL_CL_CD = '02' THEN '수정세금계산서'               WHEN A.ETAXBIL_CL_CD = '03' THEN '계산서'               WHEN A.ETAXBIL_CL_CD = '04' THEN '수정계산서'               ELSE '' END) AS DOC_CLASS     , A.LAST_DOC_STATUS     , D1.COM_NM As LAST_DOC_STATUS_NM     , A.TAX_MGMT_NO     , (CASE WHEN A.ETAXBIL_CL_CD IN ('01','02') AND ETAXBIL_KND_CD = '01' THEN '과세'             WHEN A.ETAXBIL_CL_CD IN ('01','02') AND ETAXBIL_KND_CD = '02' THEN '영세'             WHEN A.ETAXBIL_CL_CD IN ('03','04') THEN '면세'             ELSE '' END) AS DOC_TYPE     , A.WRITE_DT     , SUBSTR(A.ISU_DATE,1,8) As ISU_YMD     , ELVISBILL.CRYPTO_AES256.DEC_AES@EVB(C2.TRADE_NM) As TRADE_NM     , TO_NUMBER(ELVISBILL.CRYPTO_AES256.DEC_AES@EVB(A.SUP_SM_AMT)) AS SUP_SM_AMT     , TO_NUMBER(ELVISBILL.CRYPTO_AES256.DEC_AES@EVB(A.VAT_SM_AMT)) AS VAT_SM_AMT     , TO_NUMBER(ELVISBILL.CRYPTO_AES256.DEC_AES@EVB(A.TOT_AMT)) AS TOT_AMT     , A.BL_NO     , A.INV_NO     , A.ETAXBIL_RVS_CS_CD     , D2.COM_NM AS ETAXBIL_RVS_CS_NM     , A.ETAXBIL_NOTE     , A.TAX_DOC_NO     , 1 As DOC_SEQ     , A.INS_YMD
     , ELVISBILL.CRYPTO_AES256.DEC_AES@EVB(A.DMDER_BUSN_ID) AS DMDER_BUSN_ID  FROM ELVISBILL.EVB_TAX_MST@EVB A INNER JOIN ELVISBILL.EVB_MEMB_SET@EVB B ON A.INS_USR = B.USER_AUTH_ID  LEFT JOIN ELVISBILL.EVB_TAX_OFFC@EVB C1 ON A.TAX_DOC_NO = C1.TAX_DOC_NO AND C1.BUSN_KND_CD = '01'  LEFT JOIN ELVISBILL.EVB_TAX_OFFC@EVB C2 ON A.TAX_DOC_NO = C2.TAX_DOC_NO AND C2.BUSN_KND_CD = '02'  LEFT JOIN ELVISBILL.EVB_COM_CD@EVB D1 ON A.LAST_DOC_STATUS = D1.COM_CD AND D1.GRP_CD = 'ETAX_RCPT_CD'  LEFT JOIN ELVISBILL.EVB_COM_CD@EVB D2 ON A.ETAXBIL_RVS_CS_CD = D2.COM_CD AND D2.GRP_CD = 'RVS_CS_CD' WHERE B.USER_AUTH_ID = '@USER_AUTH_ID'   AND A.INS_YMD BETWEEN '@INS_YMD_FROM' AND '@INS_YMD_TO' -- 발행일자 [TAX_MGMT_NO]   AND A.TAX_MGMT_NO = '@TAX_MGMT_NO' -- 세금계산서번호 [/TAX_MGMT_NO] [BL_INV_NO]   AND (A.BL_NO = '@BL_INV_NO' OR A.INV_NO = '@BL_INV_NO') -- Invoice No [/BL_INV_NO] [EMAIL]   AND C2.MAIN_OFFC_EMAIL_ADDR LIKE '%@EMAIL%' [/EMAIL] [TRADE_NM]	AND ELVISBILL.CRYPTO_AES256.DEC_AES@EVB(C2.TRADE_NM) LIKE '%@TRADE_NM%' -- 공급받는 [/TRADE_NM]UNION ALL -- 입금표SELECT 'N' As CHK	 , 'CRD' AS DOC_DIV     , '입금표' AS DOC_CLASS     , 'SO' As LAST_DOC_STATUS     , '문서접수' As LAST_DOC_STATUS_NM     , A.CRD_NO As TAX_MGMT_NO     , (CASE WHEN A.DOC_DIV = 'C1' THEN '일반'             ELSE '대리점' END) AS DOC_TYPE     , A.WRITE_DT     , SUBSTR(A.ISU_DATE,1,8) As ISU_YMD     , C.DMDER_TRADE_NM As TRADE_NM     , 0 AS SUP_SM_AMT     , 0 AS VAT_SM_AMT     , A.TOT_AMT AS TOT_AMT     , A.BL_NO     , '' As INV_NO     , '' As ETAXBIL_RVS_CS_CD     , '' AS ETAXBIL_RVS_CS_NM     , '' As ETAXBIL_NOTE     , A.CRD_DOC_NO As TAX_DOC_NO     , 2 As DOC_SEQ     , A.INS_YMD
     , '' AS DMDER_BUSN_ID  FROM ELVISBILL.EVB_CRD_MST@EVB A INNER JOIN ELVISBILL.EVB_MEMB_SET@EVB B ON A.INS_USR = B.USER_AUTH_ID  LEFT JOIN ELVISBILL.EVB_ADD_OFFC@EVB C ON A.CRD_DOC_NO = C.ADD_DOC_NO WHERE B.USER_AUTH_ID = '@USER_AUTH_ID'   AND A.INS_YMD BETWEEN '@INS_YMD_FROM' AND '@INS_YMD_TO' -- 발행일자 [CRD_NO]   AND A.CRD_NO = '@CRD_NO' -- 세금계산서번호 [/CRD_NO] [BL_NO]   AND A.BL_NO = '@BL_INV_NO' -- BL or Invoice No자 [/BL_NO] [EMAIL]   AND C.MAIN_OFFC_EMAIL_ADDR LIKE '%@EMAIL%' [/EMAIL] [TRADE_NM]	AND C.DMDER_TRADE_NM LIKE '%@TRADE_NM%' -- 공급받는 [/TRADE_NM]) A1[DOC_DIV]WHERE A1.DOC_DIV = '@DOC_DIV'[/DOC_DIV] ORDER BY INS_YMD DESC, DOC_SEQ, TAX_MGMT_NO
#EvbMgmtHistory@SearchEmail
--EvbMgmtHistory@SearchEmailSELECT A.DOC_NO     , A.SEQ_NO     , A.DOC_TYPE     , A.EMAIL_ADDR                          -- 이메일주소     , A.INS_YMD || A.INS_HM As INS_DTM             -- 생성일시     , A.MAIL_SND_YN                         -- 이메일 전송여부     , A.MAIL_SND_LOG                        -- Log  FROM ELVISBILL.EVB_EMAIL_RESEND@EVB A WHERE DOC_NO = '@DOC_NO'
#EvbMgmtHistory@SearchStatus
--EvbMgmtHistory@SearchStatusSELECT A.TAX_DOC_NO     , A.SEQ_NO     , A.RCPT_CD     , A.RCPT_NM                             -- 전송상태     , A.INS_YMD || A.INS_HM As INS_DTM         -- 생성일시     , A.RCPT_ACK_DTM                    -- 응답수신일시     , A.MAIL_SND_YN                        -- 이메일 전송여부     , A.MAIL_SND_LOG                        -- Log  FROM ELVISBILL.EVB_TAX_STAS@EVB A WHERE TAX_DOC_NO = '@TAX_DOC_NO'
#EvbMgmtHistory@Update
--EvbMgmtHistory@UpdateUPDATE ELVISBILL.EVB_TAX_STAS@EVB   SET RCPT_ACK_DTM = NULL WHERE TAX_DOC_NO = '@TAX_DOC_NO'   AND SEQ_NO = '@SEQ_NO'
#EvbMgmtHistory@UpdateAll
--EvbMgmtHistory@UpdateAllUPDATE ELVISBILL.EVB_TAX_STAS@EVB   SET RCPT_ACK_DTM = NULL WHERE TAX_DOC_NO = '@TAX_DOC_NO'   AND SEQ_NO = (SELECT MAX(SEQ_NO) FROM  ELVISBILL.EVB_TAX_STAS@EVB WHERE TAX_DOC_NO = '@TAX_DOC_NO')
