#EvbSendStatis@SearchDOC
--EvbSendStatis@SearchDOCSELECT B.USER_AUTH_ID     , B.BUSN_NM     , B.BUSN_NO     , COUNT(A.TAX_DOC_NO) As TOT_CNT     , SUM((SELECT (CASE WHEN COUNT(S.TAX_DOC_NO) > 0 THEN 1 ELSE 0 END) FROM ELVISBILL.EVB_TAX_STAS@EVB S WHERE S.TAX_DOC_NO = A.TAX_DOC_NO AND S.RCPT_CD = 'BS')) As BS_CNT     , SUM((SELECT (CASE WHEN COUNT(S.TAX_DOC_NO) > 0 THEN 1 ELSE 0 END) FROM ELVISBILL.EVB_TAX_STAS@EVB S WHERE S.TAX_DOC_NO = A.TAX_DOC_NO AND S.RCPT_CD IN ('BR', 'LF'))) As BRLF_CNT     , SUM((SELECT (CASE WHEN COUNT(S.TAX_DOC_NO) > 0 THEN 1 ELSE 0 END) FROM ELVISBILL.EVB_TAX_STAS@EVB S WHERE S.TAX_DOC_NO = A.TAX_DOC_NO AND S.RCPT_CD = 'NS')) As NS_CNT     , SUM((SELECT (CASE WHEN COUNT(S.TAX_DOC_NO) > 0 THEN 1 ELSE 0 END) FROM ELVISBILL.EVB_TAX_STAS@EVB S WHERE S.TAX_DOC_NO = A.TAX_DOC_NO AND S.RCPT_CD = 'NE')) As NE_CNT     , MAX((SELECT COUNT(*) FROM ELVISBILL.EVB_CRD_MST@EVB WHERE INS_USR = B.USER_AUTH_ID AND A.INS_YMD BETWEEN '@YEAR_MONTH_FM' AND '@YEAR_MONTH_TO')) As CRD_CNT  FROM ELVISBILL.EVB_TAX_MST@EVB A INNER JOIN ELVISBILL.EVB_MEMB_SET@EVB B ON A.INS_USR = B.USER_AUTH_ID WHERE A.INS_YMD BETWEEN '@YEAR_MONTH_FM' AND '@YEAR_MONTH_TO' [SEARCH_KEY]   AND ( 1=2       OR B.BUSN_NO LIKE REPLACE('%@SEARCH_KEY%', '-','')       OR B.BUSN_NM LIKE '%@SEARCH_KEY%'       OR B.USER_AUTH_ID LIKE '@SEARCH_KEY%'        ) [/SEARCH_KEY] GROUP BY B.USER_AUTH_ID        , B.BUSN_NM        , B.BUSN_NO
#EvbSendStatis@SearchYMD
--EvbSendStatis@SearchYMDSELECT B.USER_AUTH_ID     , B.BUSN_NM     , B.BUSN_NO     , '세금계산서' As DOC_TYPE_NM     , COUNT(A.TAX_DOC_NO) As TOT_CNT     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '01' THEN 1 ELSE 0 END) As CNT_01     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '02' THEN 1 ELSE 0 END) As CNT_02     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '03' THEN 1 ELSE 0 END) As CNT_03     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '04' THEN 1 ELSE 0 END) As CNT_04     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '05' THEN 1 ELSE 0 END) As CNT_05     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '06' THEN 1 ELSE 0 END) As CNT_06     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '07' THEN 1 ELSE 0 END) As CNT_07     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '08' THEN 1 ELSE 0 END) As CNT_08     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '09' THEN 1 ELSE 0 END) As CNT_09     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '10' THEN 1 ELSE 0 END) As CNT_10     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '11' THEN 1 ELSE 0 END) As CNT_11     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '12' THEN 1 ELSE 0 END) As CNT_12     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '13' THEN 1 ELSE 0 END) As CNT_13     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '14' THEN 1 ELSE 0 END) As CNT_14     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '15' THEN 1 ELSE 0 END) As CNT_15     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '16' THEN 1 ELSE 0 END) As CNT_16     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '17' THEN 1 ELSE 0 END) As CNT_17     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '18' THEN 1 ELSE 0 END) As CNT_18     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '19' THEN 1 ELSE 0 END) As CNT_19     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '20' THEN 1 ELSE 0 END) As CNT_20     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '21' THEN 1 ELSE 0 END) As CNT_21     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '22' THEN 1 ELSE 0 END) As CNT_22     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '23' THEN 1 ELSE 0 END) As CNT_23     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '24' THEN 1 ELSE 0 END) As CNT_24     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '25' THEN 1 ELSE 0 END) As CNT_25     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '26' THEN 1 ELSE 0 END) As CNT_26     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '27' THEN 1 ELSE 0 END) As CNT_27     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '28' THEN 1 ELSE 0 END) As CNT_28     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '29' THEN 1 ELSE 0 END) As CNT_29     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '30' THEN 1 ELSE 0 END) As CNT_30     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '31' THEN 1 ELSE 0 END) As CNT_31     , 1 As DOC_SEQ  FROM ELVISBILL.EVB_TAX_MST@EVB A INNER JOIN ELVISBILL.EVB_MEMB_SET@EVB B ON A.INS_USR = B.USER_AUTH_ID WHERE SUBSTR(A.INS_YMD,1,6) = '@YEAR_MONTH' [SEARCH_KEY]   AND ( 1=2       OR B.BUSN_NO LIKE REPLACE('%@SEARCH_KEY%', '-','')       OR B.BUSN_NM LIKE '%@SEARCH_KEY%'       OR B.USER_AUTH_ID LIKE '@SEARCH_KEY%'        ) [/SEARCH_KEY] GROUP BY B.USER_AUTH_ID        , B.BUSN_NM        , B.BUSN_NOUNION ALLSELECT B.USER_AUTH_ID     , B.BUSN_NM     , B.BUSN_NO     , '입금표' As DOC_TYPE_NM     , COUNT(A.CRD_DOC_NO) As TOT_CNT     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '01' THEN 1 ELSE 0 END) As CNT_01     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '02' THEN 1 ELSE 0 END) As CNT_02     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '03' THEN 1 ELSE 0 END) As CNT_03     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '04' THEN 1 ELSE 0 END) As CNT_04     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '05' THEN 1 ELSE 0 END) As CNT_05     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '06' THEN 1 ELSE 0 END) As CNT_06     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '07' THEN 1 ELSE 0 END) As CNT_07     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '08' THEN 1 ELSE 0 END) As CNT_08     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '09' THEN 1 ELSE 0 END) As CNT_09     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '10' THEN 1 ELSE 0 END) As CNT_10     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '11' THEN 1 ELSE 0 END) As CNT_11     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '12' THEN 1 ELSE 0 END) As CNT_12     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '13' THEN 1 ELSE 0 END) As CNT_13     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '14' THEN 1 ELSE 0 END) As CNT_14     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '15' THEN 1 ELSE 0 END) As CNT_15     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '16' THEN 1 ELSE 0 END) As CNT_16     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '17' THEN 1 ELSE 0 END) As CNT_17     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '18' THEN 1 ELSE 0 END) As CNT_18     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '19' THEN 1 ELSE 0 END) As CNT_19     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '20' THEN 1 ELSE 0 END) As CNT_20     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '21' THEN 1 ELSE 0 END) As CNT_21     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '22' THEN 1 ELSE 0 END) As CNT_22     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '23' THEN 1 ELSE 0 END) As CNT_23     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '24' THEN 1 ELSE 0 END) As CNT_24     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '25' THEN 1 ELSE 0 END) As CNT_25     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '26' THEN 1 ELSE 0 END) As CNT_26     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '27' THEN 1 ELSE 0 END) As CNT_27     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '28' THEN 1 ELSE 0 END) As CNT_28     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '29' THEN 1 ELSE 0 END) As CNT_29     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '30' THEN 1 ELSE 0 END) As CNT_30     , SUM(CASE WHEN SUBSTR(A.INS_YMD,7,2) = '31' THEN 1 ELSE 0 END) As CNT_31     , 2 As DOC_SEQ  FROM ELVISBILL.EVB_CRD_MST@EVB A INNER JOIN ELVISBILL.EVB_MEMB_SET@EVB B ON A.INS_USR = B.USER_AUTH_ID WHERE SUBSTR(A.INS_YMD,1,6) = '@YEAR_MONTH' [SEARCH_KEY]   AND ( 1=2       OR B.BUSN_NO LIKE REPLACE('%@SEARCH_KEY%', '-','')       OR B.BUSN_NM LIKE '%@SEARCH_KEY%'       OR B.USER_AUTH_ID LIKE '@SEARCH_KEY%'        ) [/SEARCH_KEY] GROUP BY B.USER_AUTH_ID        , B.BUSN_NM        , B.BUSN_NO ORDER BY BUSN_NM, DOC_SEQ
